function dataset_names = ICP_get_dataset_names(publication_name)
% ICP_get_dataset_names loads the "sheet" names contained within a
%   specified ice core data collection and saves as a cell array. Used in
%   conjunction with readICP() for specifying a second input argument.
%
% SYNTAX
%  dataset_names = ICP_get_dataset_names(publication_name)
%
% DESCRIPTION
%  The input 'publication_name' is a string containing the name of an ice
%  core publication as generated by the ICP_get_publication_names function.
%  This input tells ICP_get_dataset_names the location of the corresponding
%  Excel "sheet" names.
%
%
% Note that spelling is case sensitive; multiple-word inputs require a
% hyphen between words.
%
% See also
% ICP_get_publication_names readICP

% COPYRIGHT
%  Â©Austin M. Weber 2023

% Import table of ice core names and their corresponding publications
pathname = pwd;
filename = [pathname '/Data/byrd-data-info.xlsx'];
name_table = readtable(filename,...
	'NumHeaderLines',1,'VariableNamingRule','preserve',...
	'Sheet','sheet_names');

% Search for core name that matches the input argument
for n = 1:size(name_table,2) % No. columns in 'names'
	if strcmp(name_table.Properties.VariableNames(n),publication_name)
		break
	end
end
sheet_names = name_table(:,n);
sheet_names = rmmissing(sheet_names);

% Output
dataset_names = table2array(sheet_names);

end